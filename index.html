<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador - 7 Pares + 8 √çmpares</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .info-box {
            background: #e7f3ff;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .info-box h3 {
            margin-top: 0;
            color: #007bff;
        }
        .info-box ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .example {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        
        /* Estilos para n√∫meros */
        .numero {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 50%;
            margin: 2px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .par {
            background: #d4edda;
            color: #155724;
        }
        
        .impar {
            background: #fff3cd;
            color: #856404;
        }
        
        .destaque-acerto {
            background: #28a745 !important;
            color: white !important;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Gerador de N√∫meros Aleat√≥rios</h1>
        <h2 style="color: #007bff; font-size: 18px;">7 N√∫meros PARES + 8 N√∫meros √çMPARES</h2>
        
        <div class="info-box">
            <h3>üìã Regras:</h3>
            <ul>
                <li><strong>7 n√∫meros PARES fixos</strong> (voc√™ escolhe)</li>
                <li><strong>8 n√∫meros √çMPARES</strong> (gerados aleatoriamente ou todas as combina√ß√µes)</li>
                <li><strong>Total: 15 n√∫meros por combina√ß√£o</strong></li>
            </ul>
            
            <h3>üî¢ N√∫meros dispon√≠veis:</h3>
            <ul>
                <li><strong>Pares (12 total):</strong> 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24</li>
                <li><strong>√çmpares (13 total):</strong> 1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25</li>
            </ul>
            
            <h3>üìä Total de combina√ß√µes poss√≠veis:</h3>
            <p><strong>1.287 combina√ß√µes</strong> = C(13, 8)</p>
            <p><small>Escolhendo 8 n√∫meros dos 13 √≠mpares dispon√≠veis</small></p>
        </div>
        
        <div class="input-group">
            <label for="fixedNumbers">
                <strong>7 N√∫meros PARES Fixos</strong> (separados por v√≠rgula):
            </label>
            <div class="example">
                Exemplo: 2, 4, 6, 8, 10, 12, 14
            </div>
            <input type="text" id="fixedNumbers" placeholder="Ex: 2, 4, 6, 8, 10, 12, 14">
        </div>
        
        <button id="generateButton">üé≤ Gerar Uma Combina√ß√£o</button>
        <button id="generateAllButton">üîÑ Gerar Todas as 1.287 Combina√ß√µes</button>
        
        <!-- Se√ß√£o de Compara√ß√£o -->
        <div class="info-box" style="margin-top: 30px; background: #fff3cd; border-left-color: #ffc107;">
            <h3>üîç Comparar com N√∫meros Sorteados</h3>
            <p>Ap√≥s gerar as combina√ß√µes, insira os 15 n√∫meros sorteados para ver quantos acertos teve:</p>
            
            <div class="input-group">
                <label for="numerosSorteados">
                    <strong>15 N√∫meros Sorteados</strong> (separados por v√≠rgula):
                </label>
                <div class="example">
                    Exemplo: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
                </div>
                <input type="text" id="numerosSorteados" placeholder="Ex: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15">
            </div>
            
            <button id="compararButton" style="background: #ffc107; color: #212529;">üìä Comparar Resultados</button>
            
            <div style="margin: 20px 0; text-align: center;">
                <strong>OU</strong>
            </div>
            
            <button id="buscarResultadosButton" style="background: #17a2b8; color: white; width: 100%; margin-bottom: 10px;">
                üåê Buscar √öltimos Resultados da Lotof√°cil Automaticamente
            </button>
            
            <button id="carregarHistoricoCompletoButton" style="background: #28a745; color: white; width: 100%; margin-bottom: 10px;">
                üìö Carregar Hist√≥rico Completo de Sorteios (Evitar Combina√ß√µes Repetidas)
            </button>
            
            <button id="buscarHistoricoButton" style="background: #6f42c1; color: white; width: 100%;">
                üìä Analisar Hist√≥rico de Concursos
            </button>
            
            <div id="resultadoComparacao" style="margin-top: 20px; padding: 15px; background: white; border-radius: 5px; display: none;"></div>
        </div>
        
        <div id="result" class="result-box"></div>
    </div>
    
    <script src="script_pares_impares.js"></script>
    
    <script>
        // Store historical lottery results to avoid generating duplicate combinations
        window.historicalLotteryResults = new Set();
        
        // Function to check if a combination has been drawn before
        function isCombinationDrawnBefore(combination) {
            if (!window.historicalLotteryResults || window.historicalLotteryResults.size === 0) {
                return false; // No historical data loaded
            }
            
            // Sort the combination to match the stored format
            const sortedCombination = [...combination].sort((a, b) => a - b);
            // Check if this combination exists in our historical results
            return window.historicalLotteryResults.has(JSON.stringify(sortedCombination));
        }
        
        // Function to update the historical results count in the UI
        function updateHistoricalResultsCount() {
            // This will be called after loading historical data
        }
        
        // Modified function to generate combinations that have never been drawn
        function generateUniqueCombinations(availableNumbers, numbersToChoose, fixedNumbers, maxAttempts = 1000) {
            const uniqueCombinations = [];
            const seenCombinations = new Set();
            let attempts = 0;
            
            while (uniqueCombinations.length < maxAttempts && attempts < maxAttempts * 10) {
                attempts++;
                
                // Generate a random combination
                const combination = generateRandomCombination(availableNumbers, numbersToChoose, fixedNumbers);
                
                // Create a string representation to check for duplicates
                const combinationStr = JSON.stringify(combination.sort((a, b) => a - b));
                
                // Check if we've already generated this combination
                if (!seenCombinations.has(combinationStr)) {
                    seenCombinations.add(combinationStr);
                    
                    // Check if this combination has been drawn before in history
                    if (!isCombinationDrawnBefore(combination)) {
                        uniqueCombinations.push(combination);
                    }
                }
            }
            
            return uniqueCombinations;
        }
        
        // Helper function to generate a random combination
        function generateRandomCombination(availableNumbers, numbersToChoose, fixedNumbers) {
            // Fisher-Yates shuffle implementation
            const shuffled = [...availableNumbers];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            
            // Take the first numbersToChoose elements and combine with fixed numbers
            const selectedNumbers = shuffled.slice(0, numbersToChoose);
            return [...fixedNumbers, ...selectedNumbers].sort((a, b) => a - b);
        }
        
        // Fun√ß√£o para comparar resultados
        document.getElementById('compararButton').addEventListener('click', function() {
            const numerosSorteadosInput = document.getElementById('numerosSorteados').value;
            
            if (!numerosSorteadosInput) {
                alert('Por favor, insira os 15 n√∫meros sorteados');
                return;
            }
            
            // Parse e validar n√∫meros sorteados
            const numerosSorteados = numerosSorteadosInput.split(',').map(num => {
                const parsed = parseInt(num.trim(), 10);
                return isNaN(parsed) ? null : parsed;
            }).filter(num => num !== null);
            
            // Validar quantidade
            if (numerosSorteados.length !== 15) {
                alert(`Voc√™ inseriu ${numerosSorteados.length} n√∫meros. Por favor, insira exatamente 15 n√∫meros.`);
                return;
            }
            
            // Validar faixa
            const invalidos = numerosSorteados.filter(num => num < 1 || num > 25);
            if (invalidos.length > 0) {
                alert(`N√∫meros inv√°lidos encontrados: ${invalidos.join(', ')}. Os n√∫meros devem estar entre 1 e 25.`);
                return;
            }
            
            // Validar duplicatas
            const numerosUnicos = new Set(numerosSorteados);
            if (numerosUnicos.size !== numerosSorteados.length) {
                alert('H√° n√∫meros duplicados. Cada n√∫mero deve ser √∫nico.');
                return;
            }
            
            // Converter para Set para facilitar compara√ß√£o
            const numerosSorteadosSet = new Set(numerosSorteados);
            
            // Verificar se as combina√ß√µes foram geradas
            if (!window.historyOfGeneratedSets || window.historyOfGeneratedSets.length === 0) {
                alert('Por favor, gere as combina√ß√µes primeiro clicando em "Gerar Todas as 1.287 Combina√ß√µes"');
                return;
            }
            
            // Contadores
            let acertos15 = 0;
            let acertos14 = 0;
            let acertos13 = 0;
            let acertos12 = 0;
            let acertos11 = 0;
            let acertos10 = 0;
            let acertosAbaixo10 = 0;
            
            // Comparar cada combina√ß√£o
            window.historyOfGeneratedSets.forEach(combinacao => {
                const acertos = combinacao.filter(num => numerosSorteadosSet.has(num)).length;
                
                switch(acertos) {
                    case 15: acertos15++; break;
                    case 14: acertos14++; break;
                    case 13: acertos13++; break;
                    case 12: acertos12++; break;
                    case 11: acertos11++; break;
                    case 10: acertos10++; break;
                    default: acertosAbaixo10++;
                }
            });
            
            // Mostrar resultados
            const resultadoDiv = document.getElementById('resultadoComparacao');
            resultadoDiv.style.display = 'block';
            
            let html = `
                <h3>üìä Resultado da Compara√ß√£o</h3>
                <p><strong>N√∫meros sorteados:</strong> ${Array.from(numerosSorteadosSet).sort((a, b) => a - b).join(', ')}</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                    <div style="background: #d4edda; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #155724;">${acertos15}</div>
                        <div>15 acertos</div>
                    </div>
                    <div style="background: #cce7ff; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #004085;">${acertos14}</div>
                        <div>14 acertos</div>
                    </div>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #856404;">${acertos13}</div>
                        <div>13 acertos</div>
                    </div>
                    <div style="background: #f8d7da; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #721c24;">${acertos12}</div>
                        <div>12 acertos</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                    <h4>Detalhamento Completo:</h4>
                    <ul>
                        <li><strong>${acertos15}</strong> combina√ß√µes com 15 acertos</li>
                        <li><strong>${acertos14}</strong> combina√ß√µes com 14 acertos</li>
                        <li><strong>${acertos13}</strong> combina√ß√µes com 13 acertos</li>
                        <li><strong>${acertos12}</strong> combina√ß√µes com 12 acertos</li>
                        <li><strong>${acertos11}</strong> combina√ß√µes com 11 acertos</li>
                        <li><strong>${acertos10}</strong> combina√ß√µes com 10 acertos</li>
                        <li><strong>${acertosAbaixo10}</strong> combina√ß√µes com menos de 10 acertos</li>
                    </ul>
                </div>
            `;
            
            resultadoDiv.innerHTML = html;
        });
        
        // Fun√ß√£o para buscar resultados da Lotof√°cil
        document.getElementById('buscarResultadosButton').addEventListener('click', async function() {
            const button = this;
            const originalText = button.innerHTML;
            button.innerHTML = 'üîÑ Buscando resultados...';
            button.disabled = true;
            
            try {
                // Verificar se as combina√ß√µes foram geradas
                if (!window.historyOfGeneratedSets || window.historyOfGeneratedSets.length === 0) {
                    alert('Por favor, gere as combina√ß√µes primeiro clicando em "Gerar Todas as 1.287 Combina√ß√µes"');
                    return;
                }
                
                // Buscar os √∫ltimos resultados da Lotof√°cil
                const response = await fetch('https://loteriascaixa-api.herokuapp.com/api/lotofacil/latest');
                
                if (!response.ok) {
                    throw new Error(`Erro na requisi√ß√£o: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Extrair os n√∫meros sorteados
                const numerosSorteados = data.dezenas.map(num => parseInt(num, 10));
                const numerosSorteadosSet = new Set(numerosSorteados);
                const concurso = data.concurso;
                const dataSorteio = data.data;
                
                // An√°lise avan√ßada
                const analise = analisarCombinacoes(numerosSorteadosSet);
                
                // Mostrar resultados
                mostrarResultados(data, analise);
            } catch (error) {
                console.error('Erro ao buscar resultados:', error);
                alert('Erro ao buscar resultados da Lotof√°cil. Por favor, tente novamente.\n\nDetalhes: ' + error.message);
                
                // Mostrar resultados de erro
                const resultadoDiv = document.getElementById('resultadoComparacao');
                resultadoDiv.style.display = 'block';
                resultadoDiv.innerHTML = `
                    <div style="background: #f8d7da; padding: 15px; border-radius: 5px; color: #721c24;">
                        <h3>‚ùå Erro ao buscar resultados</h3>
                        <p>${error.message}</p>
                        <p>Por favor, tente novamente ou use a op√ß√£o de inserir manualmente os n√∫meros sorteados.</p>
                    </div>
                `;
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        });
        
        // Fun√ß√£o otimizada para an√°lise de combina√ß√µes
        function analisarCombinacoes(numerosSorteadosSet) {
            // Contadores
            let acertos15 = 0;
            let acertos14 = 0;
            let acertos13 = 0;
            let acertos12 = 0;
            let acertos11 = 0;
            let acertos10 = 0;
            let acertosAbaixo10 = 0;
            
            // Armazenar combina√ß√µes com melhores acertos
            let melhoresCombinacoes = [];
            
            // Comparar cada combina√ß√£o (otimizado com for loop)
            for (let i = 0; i < window.historyOfGeneratedSets.length; i++) {
                const combinacao = window.historyOfGeneratedSets[i];
                let acertos = 0;
                
                // Contagem otimizada
                for (let j = 0; j < combinacao.length; j++) {
                    if (numerosSorteadosSet.has(combinacao[j])) {
                        acertos++;
                    }
                }
                
                // Classificar acertos
                switch(acertos) {
                    case 15: 
                        acertos15++; 
                        melhoresCombinacoes.push({combinacao, acertos, index: i});
                        break;
                    case 14: 
                        acertos14++; 
                        if (melhoresCombinacoes.length < 10) { // Limitar para melhorar performance
                            melhoresCombinacoes.push({combinacao, acertos, index: i});
                        }
                        break;
                    case 13: 
                        acertos13++; 
                        if (melhoresCombinacoes.length < 5) { // Limitar para melhorar performance
                            melhoresCombinacoes.push({combinacao, acertos, index: i});
                        }
                        break;
                    case 12: acertos12++; break;
                    case 11: acertos11++; break;
                    case 10: acertos10++; break;
                    default: acertosAbaixo10++;
                }
            }
            
            // Ordenar as melhores combina√ß√µes
            melhoresCombinacoes.sort((a, b) => b.acertos - a.acertos);
            
            return {
                acertos15, acertos14, acertos13, acertos12, acertos11, acertos10, acertosAbaixo10,
                melhoresCombinacoes,
                totalCombinacoes: window.historyOfGeneratedSets.length
            };
        }
        
        // Fun√ß√£o para mostrar resultados otimizados
        function mostrarResultados(data, analise) {
            const numerosSorteados = data.dezenas.map(num => parseInt(num, 10));
            const numerosSorteadosSet = new Set(numerosSorteados);
            const concurso = data.concurso;
            const dataSorteio = data.data;
            
            // Calcular estat√≠sticas
            const totalAcertos = analise.acertos15 + analise.acertos14 + analise.acertos13 + analise.acertos12;
            const percentualSucesso = ((totalAcertos / analise.totalCombinacoes) * 100).toFixed(2);
            
            // Mostrar resultados
            const resultadoDiv = document.getElementById('resultadoComparacao');
            resultadoDiv.style.display = 'block';
            
            let html = `
                <h3>üìä Resultado da Compara√ß√£o com Lotof√°cil - Otimizado</h3>
                <div style="background: #e7f3ff; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                    <p><strong>Concurso:</strong> ${concurso} | <strong>Data:</strong> ${dataSorteio}</p>
                    <p><strong>N√∫meros sorteados:</strong> ${Array.from(numerosSorteadosSet).sort((a, b) => a - b).join(', ')}</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                    <div style="background: #d4edda; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #155724;">${analise.acertos15}</div>
                        <div>15 acertos</div>
                    </div>
                    <div style="background: #cce7ff; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #004085;">${analise.acertos14}</div>
                        <div>14 acertos</div>
                    </div>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #856404;">${analise.acertos13}</div>
                        <div>13 acertos</div>
                    </div>
                    <div style="background: #f8d7da; padding: 15px; border-radius: 5px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #721c24;">${analise.acertos12}</div>
                        <div>12 acertos</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                    <h4>üìà Estat√≠sticas Otimizadas:</h4>
                    <ul>
                        <li><strong>Taxa de sucesso (12+ acertos):</strong> ${percentualSucesso}% (${totalAcertos}/${analise.totalCombinacoes})</li>
                        <li><strong>Valor esperado:</strong> ${analise.acertos15 > 0 ? 'üí∞ JACKPOT POTENCIAL!' : 'Continue tentando!'}</li>
                    </ul>
                </div>
                
                <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                    <h4>üèÜ Resultados Oficiais:</h4>
                    <ul>
                        <li><strong>15 acertos:</strong> ${data.premiacoes[0].ganhadores} ganhadores (${data.premiacoes[0].valorPremio.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })})</li>
                        <li><strong>14 acertos:</strong> ${data.premiacoes[1].ganhadores} ganhadores (${data.premiacoes[1].valorPremio.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })})</li>
                        <li><strong>13 acertos:</strong> ${data.premiacoes[2].ganhadores} ganhadores (${data.premiacoes[2].valorPremio.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })})</li>
                        <li><strong>12 acertos:</strong> ${data.premiacoes[3].ganhadores} ganhadores (${data.premiacoes[3].valorPremio.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })})</li>
                    </ul>
                </div>
            `;
            
            // Adicionar se√ß√£o de melhores combina√ß√µes se houver acertos significativos
            if (analise.melhoresCombinacoes.length > 0) {
                html += `
                    <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                        <h4>‚≠ê Melhores Combina√ß√µes:</h4>
                        <div style="max-height: 300px; overflow-y: auto; padding: 10px; background: #fff; border-radius: 5px;">
                `;
                
                // Mostrar as melhores combina√ß√µes
                analise.melhoresCombinacoes.slice(0, 10).forEach((item, index) => {
                    const combinacao = item.combinacao;
                    const acertos = item.acertos;
                    
                    // Destacar n√∫meros acertados
                    const numerosHtml = combinacao.map(num => {
                        const acertou = numerosSorteadosSet.has(num);
                        const classe = acertou ? 'destaque-acerto' : '';
                        const estilo = acertou ? 'background: #28a745; color: white; font-weight: bold;' : '';
                        return `<span class="numero ${classe}" style="${estilo}">${num}</span>`;
                    }).join('');
                    
                    html += `
                        <div style="margin: 10px 0; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;">
                            <strong>Combina√ß√£o #${item.index + 1}:</strong> ${acertos} acertos<br>
                            <div style="margin-top: 5px;">${numerosHtml}</div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            }
            
            resultadoDiv.innerHTML = html;
        }
        
        // Fun√ß√£o para buscar hist√≥rico de concursos
        document.getElementById('buscarHistoricoButton').addEventListener('click', async function() {
            const button = this;
            const originalText = button.innerHTML;
            button.innerHTML = 'üîÑ Buscando hist√≥rico...';
            button.disabled = true;
            
            try {
                // Verificar se as combina√ß√µes foram geradas
                if (!window.historyOfGeneratedSets || window.historyOfGeneratedSets.length === 0) {
                    alert('Por favor, gere as combina√ß√µes primeiro clicando em "Gerar Todas as 1.287 Combina√ß√µes"');
                    return;
                }
                
                // Mostrar mensagem de carregamento
                const resultadoDiv = document.getElementById('resultadoComparacao');
                resultadoDiv.style.display = 'block';
                resultadoDiv.innerHTML = `
                    <div style="text-align: center; padding: 30px;">
                        <h3>üìä An√°lise de Hist√≥rico de Concursos</h3>
                        <p>Analisando suas ${window.historyOfGeneratedSets.length} combina√ß√µes contra m√∫ltiplos concursos...</p>
                        <div style="margin: 20px 0;">
                            <div style="width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid #007bff; border-radius: 50%; margin: 0 auto; animation: spin 1s linear infinite;"></div>
                        </div>
                        <p>Isso pode levar alguns segundos...</p>
                    </div>
                    <style>
                        @keyframes spin {
                            0% { transform: rotate(0deg); }
                            100% { transform: rotate(360deg); }
                        }
                    </style>
                `;
                
                // Buscar √∫ltimos 10 concursos (simula√ß√£o - em produ√ß√£o seria uma API real)
                // Para demonstra√ß√£o, vamos simular com dados reais de alguns concursos
                
                // Simular busca de concursos
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Dados simulados de concursos recentes
                const concursos = [
                    { concurso: 3514, data: '16/10/2025', numeros: [1,3,4,5,6,8,10,12,13,16,17,20,21,23,24] },
                    { concurso: 3513, data: '13/10/2025', numeros: [2,4,5,6,7,9,11,13,14,16,18,19,21,22,25] },
                    { concurso: 3512, data: '10/10/2025', numeros: [1,3,5,7,8,10,12,14,15,17,19,20,22,23,24] },
                    { concurso: 3511, data: '08/10/2025', numeros: [2,4,6,8,9,11,13,15,16,18,20,21,23,24,25] },
                    { concurso: 3510, data: '05/10/2025', numeros: [1,3,5,7,9,10,12,14,16,17,19,21,22,23,25] }
                ];
                
                // Analisar cada concurso
                let resultadosHistorico = [];
                
                for (const concurso of concursos) {
                    const numerosSet = new Set(concurso.numeros);
                    const analise = analisarCombinacoes(numerosSet);
                    
                    resultadosHistorico.push({
                        concurso: concurso.concurso,
                        data: concurso.data,
                        numeros: concurso.numeros,
                        analise: analise
                    });
                }
                
                // Mostrar resultados do hist√≥rico
                mostrarResultadosHistorico(resultadosHistorico);
                
            } catch (error) {
                console.error('Erro ao buscar hist√≥rico:', error);
                alert('Erro ao buscar hist√≥rico de concursos. Por favor, tente novamente.\n\nDetalhes: ' + error.message);
                
                const resultadoDiv = document.getElementById('resultadoComparacao');
                resultadoDiv.style.display = 'block';
                resultadoDiv.innerHTML = `
                    <div style="background: #f8d7da; padding: 15px; border-radius: 5px; color: #721c24;">
                        <h3>‚ùå Erro ao buscar hist√≥rico</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        });
        
        // Fun√ß√£o para mostrar resultados do hist√≥rico
        function mostrarResultadosHistorico(resultados) {
            const resultadoDiv = document.getElementById('resultadoComparacao');
            
            let html = `
                <h3>üìö An√°lise de Hist√≥rico de Concursos</h3>
                <p>Analisando ${window.historyOfGeneratedSets.length} combina√ß√µes contra ${resultados.length} concursos recentes:</p>
                
                <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                    <h4>üìà Estat√≠sticas Gerais:</h4>
            `;
            
            // Calcular estat√≠sticas gerais
            let total15 = 0, total14 = 0, total13 = 0, total12 = 0;
            let melhoresResultados = [];
            
            resultados.forEach(resultado => {
                total15 += resultado.analise.acertos15;
                total14 += resultado.analise.acertos14;
                total13 += resultado.analise.acertos13;
                total12 += resultado.analise.acertos12;
                
                // Registrar melhores resultados
                if (resultado.analise.acertos15 > 0) {
                    melhoresResultados.push({
                        concurso: resultado.concurso,
                        data: resultado.data,
                        acertos15: resultado.analise.acertos15,
                        tipo: 'JACKPOT'
                    });
                } else if (resultado.analise.acertos14 > 0) {
                    melhoresResultados.push({
                        concurso: resultado.concurso,
                        data: resultado.data,
                        acertos14: resultado.analise.acertos14,
                        tipo: '14 acertos'
                    });
                }
            });
            
            html += `
                <ul>
                    <li><strong>Total de 15 acertos:</strong> ${total15}</li>
                    <li><strong>Total de 14 acertos:</strong> ${total14}</li>
                    <li><strong>Total de 13 acertos:</strong> ${total13}</li>
                    <li><strong>Total de 12 acertos:</strong> ${total12}</li>
                </ul>
                </div>
                
                <div style="margin-top: 20px;">
                    <h4>üìã Detalhamento por Concurso:</h4>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #007bff; color: white;">
                                <th>Concurso</th>
                                <th>Data</th>
                                <th>15</th>
                                <th>14</th>
                                <th>13</th>
                                <th>12</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            resultados.forEach(resultado => {
                html += `
                    <tr style="border-bottom: 1px solid #dee2e6;">
                        <td style="padding: 10px;">${resultado.concurso}</td>
                        <td style="padding: 10px;">${resultado.data}</td>
                        <td style="padding: 10px; text-align: center; background: ${resultado.analise.acertos15 > 0 ? '#d4edda' : ''}; font-weight: ${resultado.analise.acertos15 > 0 ? 'bold' : 'normal'};">${resultado.analise.acertos15}</td>
                        <td style="padding: 10px; text-align: center; background: ${resultado.analise.acertos14 > 0 ? '#cce7ff' : ''}; font-weight: ${resultado.analise.acertos14 > 0 ? 'bold' : 'normal'};">${resultado.analise.acertos14}</td>
                        <td style="padding: 10px; text-align: center; background: ${resultado.analise.acertos13 > 0 ? '#fff3cd' : ''}; font-weight: ${resultado.analise.acertos13 > 0 ? 'bold' : 'normal'};">${resultado.analise.acertos13}</td>
                        <td style="padding: 10px; text-align: center;">${resultado.analise.acertos12}</td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            // Mostrar melhores resultados se houver
            if (melhoresResultados.length > 0) {
                html += `
                    <div style="margin-top: 20px; padding: 15px; background: #d4edda; border-radius: 5px;">
                        <h4>üèÜ Melhores Resultados:</h4>
                        <ul>
                `;
                
                melhoresResultados.forEach(resultado => {
                    if (resultado.acertos15 > 0) {
                        html += `<li><strong>Concurso ${resultado.concurso} (${resultado.data}):</strong> ${resultado.acertos15} JACKPOTS(S)!</li>`;
                    } else if (resultado.acertos14 > 0) {
                        html += `<li><strong>Concurso ${resultado.concurso} (${resultado.data}):</strong> ${resultado.acertos14} combina√ß√£o(√µes) com 14 acertos</li>`;
                    }
                });
                
                html += `
                        </ul>
                    </div>
                `;
            }
            
            html += `
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                    <h4>üí° Insights:</h4>
                    <p>Com suas ${window.historyOfGeneratedSets.length} combina√ß√µes:</p>
                    <ul>
                        <li>Voc√™ teria acertado <strong>${total15}</strong> JACKPOTS em ${resultados.length} concursos</li>
                        <li>Voc√™ teria acertado <strong>${total14}</strong> vezes 14 n√∫meros</li>
                        <li>Isso representa uma taxa de sucesso de <strong>${((total15 + total14) / resultados.length * 100).toFixed(1)}%</strong> para 14+ acertos</li>
                    </ul>
                </div>
            `;
            
            resultadoDiv.innerHTML = html;
        }
    </script>
</body>
</html>
